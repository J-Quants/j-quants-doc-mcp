{
  "patterns": [
    {
      "pattern_name": "認証フロー",
      "description": "J-Quants APIへのアクセスに必要な認証フローの実装パターン。リフレッシュトークンとIDトークンを組み合わせて、継続的なAPI利用を可能にする。",
      "related_endpoints": [],
      "notes": [
        "APIキーはJ-QuantsのHPのダッシュボードから取得可能",
        "APIキーは環境変数や安全なストレージに保存すること",
        "APIキーはx-api-keyヘッダーで送信"
      ],
      "sample_code_path": "patterns/auth_flow.py"
    },
    {
      "pattern_name": "日次株価データの取得",
      "description": "特定銘柄の日次株価データ(四本値)を取得するパターン。期間を指定して過去の株価データを効率的に取得する。",
      "related_endpoints": [
        "/equities/bars/daily"
      ],
      "notes": [
        "codeまたはdateパラメータのいずれかが必須",
        "fromとtoパラメータで期間を指定可能",
        "大量データ取得時はページネーションが発生する可能性がある",
        "pagination_keyを使用して次のページを取得",
        "レスポンスには始値・高値・安値・終値・出来高が含まれる",
        "AdjustmentFactorで株式分割・併合の調整が可能"
      ],
      "sample_code_path": "patterns/daily_quotes.py"
    },
    {
      "pattern_name": "ページネーション対応",
      "description": "大量データを取得する際のページネーション処理パターン。pagination_keyを使用して全データを段階的に取得する。",
      "related_endpoints": [
        "/equities/bars/daily",
        "/fins/summary"
      ],
      "notes": [
        "レスポンスにpagination_keyが含まれる場合、さらにデータが存在する",
        "pagination_keyを次のリクエストに含めて継続取得",
        "pagination_keyがnullまたは存在しない場合は最終ページ",
        "ループ処理で全データを取得する実装が推奨される",
        "各リクエスト間に適切な待機時間を設けること(レート制限対策)"
      ],
      "sample_code_path": "patterns/pagination.py"
    },
    {
      "pattern_name": "レート制限対応",
      "description": "API利用時のレート制限を考慮した実装パターン。適切な待機時間とリトライ処理で安定したAPI利用を実現する。",
      "related_endpoints": [
        "全エンドポイント"
      ],
      "notes": [
        "J-Quants APIには利用制限がある(プランによって異なる)",
        "連続リクエストの場合は適切な間隔を空ける",
        "429 Too Many Requestsエラーが返された場合はリトライ",
        "Retry-Afterヘッダーがある場合はその時間待機",
        "指数バックオフ戦略の実装を推奨",
        "大量データ取得時はバッチ処理を検討"
      ],
      "sample_code_path": "patterns/rate_limit.py"
    },
    {
      "pattern_name": "財務情報の取得と分析",
      "description": "企業の財務諸表データを取得し、時系列分析を行うパターン。複数期の財務データを取得して比較分析を実現する。",
      "related_endpoints": [
        "/fins/summary",
        "/equities/master"
      ],
      "notes": [
        "codeまたはdateパラメータのいずれかが必須",
        "四半期決算データが取得可能",
        "売上高・営業利益・当期純利益・EPSなどの主要指標を含む",
        "時系列データの取得にはページネーション対応が必要",
        "上場銘柄情報と組み合わせて業種別分析が可能"
      ],
      "sample_code_path": "patterns/financial_analysis.py"
    },
    {
      "pattern_name": "市場全体の日次データ取得",
      "description": "特定日の全銘柄株価データを取得するパターン。dateパラメータを使用して市場全体のスナップショットを取得する。",
      "related_endpoints": [
        "/equities/bars/daily",
        "/equities/master"
      ],
      "notes": [
        "dateパラメータで特定日のデータを指定",
        "全銘柄データのため大量のレコードが返される",
        "必ずページネーション処理が必要",
        "上場銘柄情報と結合してセクター別分析が可能",
        "処理時間とメモリ使用量に注意"
      ],
      "sample_code_path": "patterns/market_daily_data.py"
    },
    {
      "pattern_name": "過去データの一括取得（Bulk・historical）",
      "description": "全銘柄の過去データを月次単位で一括取得するパターン。historicalファイルは前月以前の過去データが月単位でまとめられており、大量の過去データを効率的にダウンロードできる。",
      "related_endpoints": [
        "/bulk/list",
        "/bulk/get"
      ],
      "notes": [
        "過去の全データを一括でダウンロードする場合に使用",
        "historicalファイルは月単位でまとめられた大容量ファイル",
        "Keyに'historical'が含まれるファイルをフィルタリング",
        "bulk-listは昇順（古い順）で返されるため、最新から取得したい場合はreversed()を使用",
        "Bulk機能はLight、Standard、Premiumプランのみ利用可能",
        "バルクファイルはgzip形式で圧縮されている",
        "取得したURLの有効期限は5分程度のため、すぐにダウンロードする",
        "大量ダウンロード時はストレージ容量に注意"
      ],
      "sample_code_path": "patterns/bulk_download_historical.py"
    },
    {
      "pattern_name": "当月データの取得（Bulk・live）",
      "description": "全銘柄の当月分データを日次単位で取得するパターン。liveファイルは当月分の日次データで、月の上旬には先月分も含まれる。1日単位で最新データを取得できる。",
      "related_endpoints": [
        "/bulk/list",
        "/bulk/get"
      ],
      "notes": [
        "当月分の日次データを取得する場合に使用（月の上旬には先月分も取得可能）",
        "liveファイルは1日単位の小さなファイル",
        "Keyに'live'が含まれるファイルをフィルタリング",
        "bulk-listは昇順（古い順）で返されるため、最新から取得したい場合はreversed()を使用",
        "Bulk機能はLight、Standard、Premiumプランのみ利用可能",
        "バルクファイルはgzip形式で圧縮されている",
        "取得したURLの有効期限は5分程度のため、すぐにダウンロードする"
      ],
      "sample_code_path": "patterns/bulk_download_live.py"
    },
    {
      "pattern_name": "最新バルクファイルの取得",
      "description": "最新のバルクファイル1件のみを取得するパターン。historical/liveを問わず、最も新しいファイルを取得したい場合に使用する。",
      "related_endpoints": [
        "/bulk/list",
        "/bulk/get"
      ],
      "notes": [
        "とにかく最新のデータが欲しい場合に使用",
        "bulk-listは昇順（古い順）で返されるため、末尾要素（files[-1]）が最新ファイル",
        "Bulk機能はLight、Standard、Premiumプランのみ利用可能",
        "バルクファイルはgzip形式で圧縮されている",
        "取得したURLの有効期限は5分程度のため、すぐにダウンロードする"
      ],
      "sample_code_path": "patterns/bulk_download_latest.py"
    }
  ]
}
